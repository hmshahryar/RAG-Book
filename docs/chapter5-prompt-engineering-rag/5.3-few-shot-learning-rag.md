---
id: few-shot-learning-rag
title: Few-shot Learning in RAG
---

## 5.3 Few-shot Learning in RAG

Few-shot learning provides examples in the prompt to guide the LLM's output format, style, and reasoning approach. This section covers how to effectively use examples in RAG systems.

### Why Few-Shot for RAG?

**Benefits:**
- Consistent output formatting
- Domain-specific response patterns
- Improved citation practices
- Better handling of edge cases

### Basic Few-Shot Pattern

```python
def few_shot_rag_prompt(query, context, examples):
    """RAG prompt with few-shot examples."""
    
    prompt = "You are a banking compliance assistant.\n\n"
    
    # Add examples
    for ex in examples:
        prompt += f"""Example:
Question: {ex['question']}
Context: {ex['context']}
Answer: {ex['answer']}

"""
    
    # Add actual query
    prompt += f"""Now answer this question:
Question: {query}
Context: {context}
Answer:"""
    
    return prompt
```

### Banking-Specific Examples

```python
BANKING_EXAMPLES = [
    {
        "question": "What is the minimum CET1 ratio?",
        "context": "Basel III requires banks to maintain a minimum Common Equity Tier 1 ratio of 4.5%...",
        "answer": "The minimum Common Equity Tier 1 (CET1) ratio under Basel III is 4.5% of risk-weighted assets. [Source: Basel III Framework, Section 2.1]"
    },
    {
        "question": "When must stress tests be conducted?",
        "context": "Dodd-Frank requires annual stress testing for banks with assets over $100 billion...",
        "answer": "Banks with total consolidated assets exceeding $100 billion must conduct stress tests annually. [Source: Dodd-Frank Act, Title I, Section 165]"
    }
]
```

### Dynamic Example Selection

```python
from sklearn.metrics.pairwise import cosine_similarity

def select_relevant_examples(query, example_pool, k=3):
    """Select most relevant examples for the query."""
    
    # Embed query and examples
    query_emb = embedding_model.encode([query])[0]
    example_embs = embedding_model.encode([ex['question'] for ex in example_pool])
    
    # Calculate similarities
    similarities = cosine_similarity([query_emb], example_embs)[0]
    
    # Select top-k
    top_indices = similarities.argsort()[-k:][::-1]
    selected = [example_pool[i] for i in top_indices]
    
    return selected
```

### Summary

Few-shot learning improves RAG consistency and quality through examples. Use dynamic selection for relevance and balance examples with context budget.

Next: Chain-of-thought reasoning prompts.
